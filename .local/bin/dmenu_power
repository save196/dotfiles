#!/bin/bash

OUT=$(printf "Suspend\\nShutdown\\nReboot\\nHibernate" | dmenu -i -l 4)

if [ "$OUT" == "Shutdown" ]; then
    systemctl poweroff
elif [ "$OUT" == "Reboot" ]; then
    systemctl reboot
elif [ "$OUT" == "Suspend" ]; then
    if grep 1 /sys/class/power_supply/AC/online >/dev/null; then
        if [ "$XDG_SESSION_TYPE" = "wayland" ]; then
            swayidle -w timeout 1 'swaylock -f; wlopm --off "*"' resume 'wlopm --on "*"; kill ${PPID}'
        else
            xset dpms force off
        fi
    else
        systemctl suspend
    fi
elif [ "$OUT" == "Hibernate" ]; then
    systemctl hibernate
fi
